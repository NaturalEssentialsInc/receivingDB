<h2>
  {{#unless data}}
    New User
  {{else}}
    {{data.user.name.firstName}} {{data.user.name.lastName}}
  {{/unless}}
</h2>
{{#if data.user.lastLogin}}
  <div class="lastLogin">
    <p>Last login:
      <span>{{friendlyDateTime data.user.lastLogin}}</span>
    </p>
  </div>
{{/if}}
<form class="user-form" data-id="{{data.user._id}}">
  <fieldset name="login">
    <legend>Login</legend>
    <div class="form-group">
      <input
        aria-labelledby="username-label"
        id="username"
        maxLength="32"
        name="username"
        pattern="^[-_.0-9a-zA-Z]+$"
        type="text"
        {{#if data.user.username}}
          value="{{data.user.username}}"
        {{/if}}
      />
      <label for="username" id="username-label">
        Username<span class="errors"></span>
      </label>
    </div>
    <div class="form-group">
      <input
        aria-labelledby="password-label"
        id="password"
        maxLength="32"
        minLength="8"
        name="password"
        type="password"
        {{#if data.user}}
          value="****************"
        {{/if}}
      />
      <label for="password" id="password-label">
        Password<span class="errors"></span>
      </label>
    </div>
    <div class="form-group">
      <input
        aria-labelledby="reset-label"
        id="reset"
        name="reset"
        type="checkbox"
        value=true
        {{#unless data.user}}
          checked
        {{/unless}}
      />
      <label for="reset" id="reset-label">
        Require password reset on next login
      </label>
    </div>
  </fieldset>
  <fieldset name="user details">
    <legend>User details</legend>
    <div class="form-group">
      <input
        aria-labelledby="firstname-label"
        id="firstname"
        maxLength="32"
        name="firstname"
        pattern="^[-_.0-9a-zA-Z]+$"
        type="text"
        {{#if data.user.name.firstName}}
          value="{{data.user.name.firstName}}"
        {{/if}}
      />
      <label for="firstname" id="firstname-label">
        First name<span class="errors"></span>
      </label>
    </div>
    <div class="form-group">
      <input
        aria-labelledby="lastname-label"
        id="lastname"
        maxLength="32"
        name="lastname"
        pattern="^[-_.0-9a-zA-Z]+$"
        type="text"
        {{#if data.user.name.lastName}}
          value="{{data.user.name.lastName}}"
        {{/if}}
      />
      <label for="lastname" id="lastname-label">
        Last name<span class="errors"></span>
      </label>
    </div>
    <div class="form-group">
      <input
        aria-labelledby="email-label"
        id="email"
        maxLength="64"
        name="email"
        pattern="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$"
        type="email"
        {{#if data.user.email}}
          value="{{data.user.email}}"
        {{/if}}
      />
      <label for="email" id="email-label">
        Email<span class="errors"></span>
      </label>
    </div>
  </fieldset>
  <fieldset name="roles">
    <legend>Roles</legend>
    <div class="form-group roles-group">
      <label for="write" id="write-label">Write</label>
      <input
        aria-labelledby="write-label"
        id="write"
        name="role write"
        type="checkbox"
        value="WRITE"
        {{#if data.user.write}}
          checked
        {{/if}}
      />
    </div>
    <div class="form-group roles-group">
      <label for="audit" id="audit-label">Audit</label>
      <input
        aria-labelledby="audit-label"
        id="audit"
        name="role audit"
        type="checkbox"
        value="AUDIT"
        {{#if data.user.audit}}
          checked
        {{/if}}
      />
    </div>
    <div class="form-group roles-group">
      <label for="admin" id="admin-label">Admin</label>
      <input
        aria-labelledby="admin-label"
        id="admin"
        name="role admin"
        type="checkbox"
        value="ADMIN"
        {{#if data.user.admin}}
          checked
        {{/if}}
      />
    </div>
    <div class="form-group roles-group">
      <label for="disabled" id="disabled-label">Disabled</label>
      <input
        aria-labelledby="disabled-label"
        id="disabled"
        name="disabled"
        type="checkbox"
        value="disabled"
        {{#if data.user}}
          {{#unless data.user.enabled}}
            checked
          {{/unless}}
        {{/if}}
      />
    </div>
    <span class="errors"></span>
  </fieldset>
  <fieldset class="action">
    <div class="form-group">
      <input
        id="submit"
        type="submit"
        {{#if data.user}}
          value="Update"
        {{else}}
          value="Save"
        {{/if}}
      />
    </div>
  </fieldset>
  <div id="submission-errors"></div>
</form>

<script defer src="/javascripts/userForm.js"></script>
